" Install plugins
call plug#begin()
Plug 'scrooloose/nerdtree'
" Plug 'scrooloose/syntastic'
Plug 'tpope/vim-surround'
Plug 'kien/ctrlp.vim'
Plug 'bling/vim-airline'
" Plug 'majutsushi/tagbar'
Plug 'valloric/youcompleteme'
Plug 'tomtom/tcomment_vim'
Plug 'jiangmiao/auto-pairs'
Plug 'alvan/vim-closetag'
Plug 'godlygeek/tabular'
Plug 'terryma/vim-multiple-cursors'

" GIT
Plug 'tpope/vim-fugitive'
Plug 'airblade/vim-gitgutter'

" Styles and themes
Plug 'vim-airline/vim-airline-themes'
Plug 'altercation/vim-colors-solarized'
Plug 'chriskempson/base16'
Plug 'chriskempson/base16-vim'
Plug 'chriskempson/tomorrow-theme'
Plug 'w0ng/vim-hybrid'

" Language support
Plug 'rust-lang/rust.vim'
Plug 'pangloss/vim-javascript'
Plug 'mxw/vim-jsx'
Plug 'jelera/vim-javascript-syntax'
call plug#end()

" vim-closetag configurations
let g:closetag_filenames = "*.html,*.xhtml,*.phtml,*.js,*.jsx"

" JSX configuration
let g:jsx_ext_required = 0

" NERD TREE configuration
" map <C-n> :NERDTreeToggle<CR>
map <C-t> :NERDTreeToggle<CR>

" Syntastic configuration
" set statusline+=%#warningmsg#
" set statusline+=%{SyntasticStatuslineFlag()}
" set statusline+=%*
" let g:syntastic_always_populate_loc_list = 1
" let g:syntastic_auto_loc_list = 1
" let g:syntastic_check_on_open = 1
" let g:syntastic_check_on_wq = 0
" let g:syntastic_javascript_checkers = ['eslint']

" vim-airline configuration
let g:airline#extensions#tabline#enabled = 2
let g:airline#extensions#tabline#fnamemod = ':t'
let g:airline#extensions#tabline#left_sep = ' '
let g:airline#extensions#tabline#left_alt_sep = '|'
let g:airline#extensions#tabline#right_sep = ' '
let g:airline#extensions#tabline#right_alt_sep = '|'
let g:airline_left_sep = ' '
let g:airline_left_alt_sep = '|'
let g:airline_right_sep = ' '
let g:airline_right_alt_sep = '|'
" let g:airline_theme= 'luna'

" Tagbar configuration
nmap <F8> :TagbarToggle<CR>

" Rust-vim configuration
let g:rustfmt_autosave = 1

" You Complete Me configuration
let g:ycm_rust_src_path = '/home/pedro/rust/rustc/src'

" Tabular configuration
if exists(":Tabularize")
  nmap <Leader>a= :Tabularize /=<CR>
  vmap <Leader>a= :Tabularize /=<CR>
  nmap <Leader>a: :Tabularize /:\zs<CR>
  vmap <Leader>a: :Tabularize /:\zs<CR>
endif

inoremap <silent> <Bar>   <Bar><Esc>:call <SID>align()<CR>a

function! s:align()
  let p = '^\s*|\s.*\s|\s*$'
  if exists(':Tabularize') && getline('.') =~# '^\s*|' && (getline(line('.')-1) =~# p || getline(line('.')+1) =~# p)
    let column = strlen(substitute(getline('.')[0:col('.')],'[^|]','','g'))
    let position = strlen(matchstr(getline('.')[0:col('.')],'.*|\s*\zs.*'))
    Tabularize/|/l1
    normal! 0
    call search(repeat('[^|]*|',column).'\s\{-\}'.repeat('.',position),'ce',line('.'))
  endif
endfunction

set showmatch
set number              " Show number line
set ruler
set formatoptions+=o
set textwidth=0
set wrap                " Wrap lines
set hlsearch            " Highlight search results.
set ignorecase          " Make searching case insensitive
set smartcase           " ... unless the query has capital letters.
set incsearch           " Incremental search.
set gdefault            " Use 'g' flag by default with :s/foo/bar/.
set magic               " Use 'magic' patterns (extended regular expressions).
" set encoding=utf8
set ffs=unix,dos,mac

" Tabs configurations
set expandtab           " Use spaces instead tabs
set tabstop=2
set shiftwidth=2        " Tab width
set smarttab            " Be smart when using tabs

" Indent configuration
set ai                  " Auto indent
set si                  " Smart indent

" Turn backup off
set nobackup
set nowb
set noswapfile
set wildignore+=*/tmp/*,*.so,*.swp,*.zip,*/node_modules
" Theme
syntax enable
" set background=dark
" let g:hybrid_custom_term_colors = 1
" let g:hybrid_reduced_contrast = 1 " Remove this line if using the default palette.
colorscheme base16-materia
" let base16colorspace=256
" call togglebg#map("<F5>")
" let g:solarized_termcolors = 256
" let g:solarized_degrade    = 1
" let g:solarized_contrast   = "low"
" let g:solarized_visibility = "low"
if (has("termguicolors"))
  set termguicolors
endif

" More natural splits
set splitbelow          " Horizontal split below current.
set splitright          " Vertical split to right of current.

" Tell Vim which characters to show for expanded TABs,
" trailing whitespace, and end-of-lines. VERY useful!
if &listchars ==# 'eol:$'
  set listchars=tab:>\ ,trail:-,extends:>,precedes:<,nbsp:+
endif
set list                " Show problematic characters.

" Also highlight all tabs and trailing whitespace characters.
highlight ExtraWhitespace ctermbg=darkgreen guibg=darkgreen
match ExtraWhitespace /\s\+$\|\t/

" Relative numbering
function! NumberToggle()
  if(&relativenumber == 1)
    set nornu
    set number
  else
    set rnu
  endif
endfunc
call NumberToggle()

" Toggle between normal and relative numbering.
noremap <leader>r :call NumberToggle()<cr>

set clipboard+=unnamedplus

" Mapping
" Map the leader key to SPACE
let mapleader="\<SPACE>"

" Map jk to <ESC>
inoremap jk <Esc>
nnoremap <Leader>w :w<CR>
map <leader>h :set hlsearch!<cr>
